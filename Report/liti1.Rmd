---
title: Extração Conheciento Bases Dados Biológicas
   <br />Bipolar Disorder and Response to Lithium
author: "Catarina Sousa pg32934 | Davide Lagoa pg31552 | João Silva a72023 <br /> José Morais pg32943 | Marta Moreno pg32847"
date: '`r format(Sys.Date(), "%d-%m-%Y")`'
bibliography: Referencias.bibtex
output:
  html_document:
    css: tableContents.css
    toc: true
    depth: 3
    number_sections: true 
    theme: cosmo 
    highlight: haddock
---
<img src="logo.png" style = "position:absolute;top:20px;left:100px;" />

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("gplots")
#install.packages("dendextend")#para por por no heatmap nas linhas
#install.packages("dendextendRcpp")#para por por no heatmap nas linhas
#install.packages("d3heatmap")#para fazer o heatmap
source("http://bioconductor.org/biocLite.R")
biocLite()
#biocLite("GEOquery")
#biocLite("limma")
#biocLite("genefilter")
#biocLite("affydata")
#biocLite("affy")
#biocLite("illuminaHumanv4.db")

library(Biobase) 
library(GEOquery)
library('genefilter')
library(limma)
library(gplots)
library(illuminaHumanv4.db)# por causa dos nossos genes serem illumina
library(dendextend)#heatmap
library(d3heatmap)#heatmap
library(matrixStats)
library(affydata)
library(affy)
library(imager)
```

# Introdução

> <p style = 'text-align: justify;'>O lítio é um dos medicamentos mais eficazes no tratamento do **transtorno bipolar**, no entanto a resposta dos pacientes ao qual é administrado é bastante heterogénea. Apesar de se terem efetuado diversos estudos com esse fim, ainda não foram identificados biomarcadores que possam ser utilizados para monitorizar e prever a resposta ao tratamento com lítio. O estudo a ser analisado procura **avaliar os efeitos do lítio sobre a expressão génica** ao identificar alterações na expressão de genes específicos 1 mês após o início do tratamento, sendo essa informação utilizada para prever os resultados ao fim de 6 meses.
</p>

> <p style = 'text-align: justify;'> Para o estudo foram recrutados 74 pacientes, sendo que 9 desistiram antes da primeira colheita de sangue e outros 5 apresentaram fraca qualidade ou quantidade insuficiente de RNA, pelo que não constam nos resultados. Os restantes **60 pacientes** foram **divididos em 2 grupos** criados aleatoriamente: um sujeito a tratamento com pelo menos um outro *medicamento que não lítio (OPT)*, e outro que fazia o tratamento anterior acoplado com a *toma de lítio (Li + OPT)*, sendo os grupos constituídos por 32 e 28 pacientes, respetivamente.
</p>

> <p style = 'text-align: justify;'> Para o grupo *Li + OPT*, 62 genes apresentaram indução diferencial entre os pacientes que responderam ao tratamento e os que não responderam ao tratamento. Os pacientes do grupo *Li + OPT* que responderam ao tratamento apresentavam padrões distintos que não foram observados nos pacientes do grupo *OPT* com resposta ao tratamento, sendo que estes últimos eram mais parecidos com os pacientes do grupo *Li + OPT* sem resposta ao tratamento.
</p>

> <p style = 'text-align: justify;'> Também foram realizados **testes utilizando RT-PCR** em tempo real de certos genes, tendo-se verificado que os resultados desta análise foram **similares aos obtidos com microarrays**, com os pacientes *Li + OPT* com resposta ao tratamento a demonstrarem uma maior indução desses genes do que os outros grupos. No entanto, com a exceção do gene *BCL2L1*, os resultados não foram estatisticamente significativos, o que corrobora o facto de que nos estudos com *microarrays* a maior diferença foi observada para *BCL2L1* [@beech2014gene].
</p>


#Dados

> <p style = 'text-align: justify;'>
*Download* e carregamento do *DataSet* escolhido para o trabalho:
</p>

```{r dataset, message = FALSE}
#gds <- getGEO('GDS5393', destdir=".")  
```

> <p style = 'text-align: justify;'>
Conversão do *DataSet* para um *expressionset*:
</p>

```{r expressionset, message = FALSE, warning = FALSE, dependson = "dataset"}
#data <- GDS2eSet(gds,do.log2=TRUE) 
data
```
> <p style = 'text-align: justify;'>
Dimensão do *DataSet*: 
</p>
```{r , message = FALSE}
dim(data) 
```

> <p style = 'text-align: justify;'>
Conversão do *DataSet* para uma matiz numérica, contendo as *samples* nas colunas e *features* nas linhas: 
</p>
```{r , message = FALSE}
exp = exprs(data)
class(exp)
exp[5:15,1:5]
```

> <p style = 'text-align: justify;'>
Fazendo um boxplot com o logaritmo de base 2 dos dados de express~o para todas as amostras facilmente verificamos a escala e distribuiãcão dos dados. As caixas apresentam forma e centro semelhantes entre amostras, indicando que os dados de expressão já normalizados, estes dados apesar de normalizados não podem ser utilizados na análise pois ainda possuem valores omissos.
</p>

```{r boxplot, fig.width = 10, fig.align = 'center',  message = FALSE, warning = FALSE}
#col = terrain.colors(length(pData(data)$sample), alpha = 0.6)
#dataBox = log2(exp)
#boxplot(dataBox, col = col, whiskcol = col, pch = 21, cex = 0.8, xlab = 'Amostras', ylab = 'Intensidades (log2)', notch = TRUE, frame = FALSE)
#depois descomentar esta a usar a imagem para nao demorar tanto 
library(imager)
im<-load.image("Rplot.png")
plot(im,axes=FALSE)
```


##Metadados

> <p style = 'text-align: justify;'> Resumo do conteudo do *DataSet:* 
</p>

```{r , message = FALSE, warning = FALSE, dependson = "dataset"}
abstract(data)
```
> <p style = 'text-align: justify;'> Exemplo  pare verificar o nome de algumas das amostras e identificados dos genes:
</p>

```{r , message = FALSE, warning = FALSE, dependson = "dataset"}
sampleNames(data)[1:10]
featureNames(data)[1:8]
```

> <p style = 'text-align: justify;'> De maneira a solidificar o nosso conhecimento sobre o *DataSet* em estudo é muito útil termos uma ideia dos atributos disponíveis. 
</p>
```{r , message = FALSE, warning = FALSE, dependson = "dataset"}
varMetadata(data)
```
> <p style = 'text-align: justify;'> A execução do comando anterior permitiu identificar no nosso *DataSet* os seguintes atributos, sendo que nenhum deles apresenta descrição:
</p>

* sample
* agent
* other
* individual
* description
* time

> <p style = 'text-align: justify;'> Para aprofundar o nosso conhecimento sobre este *DataSet*, corremos os seguintes comandos de modo a organizar algumas ideias sobre os atributos disponíveis numa tabela. 
</p>

```{r , message = FALSE, warning = FALSE,results="hide"}
data$sample
data$agent
data$other
data$individual
data$description
data$time
```

Nome do Atributo | Significado  | Valores Distintos  | Valores Distintos 
------------- | ------------- | ------------- | -------------
sample | Amostras Disponíveis  | 120 | "GSM1105438" "GSM1105486"... 
agent | Tipo de Tratamentot | 2 |  "control" "lithium"
other| Resposta ao Tratamento | 2 | "non-responder" "responder"
individual | Indivíduos em Análise  | 60 | "Li+OPT_1" "Li+OPT_10"...
description | Descrição do Sample | 120 | NULL
time |  Momento em que foi obtida a amostra  | 2 | "1 month" "baseline"

Table: **Tabela 1** - Informação contida no *DataSet* utilizado.

> <p style = 'text-align: justify;'> 
Resposta dos diferentes grupos, *control* e *lithium* ao tratamento aplicado:
</p>

```{r , message = FALSE, warning = FALSE,include=FALSE}
data_antes = data[,data$time=="baseline"]
data_depois = data[,data$time=="1 month"]


addmargins(table(data_antes$agent,data_antes$other))
addmargins(table(data_depois$agent,data_depois$other))
```

```{r , message = FALSE, warning = FALSE}
addmargins(table(data$agent,data$other))
```
##Tratamento dos Dados
> <p style = 'text-align: justify;'>
Verificar a existência registos com valores omissos *NA's* no *DataSet* :
</p>

```{r NAs, message = FALSE, warning = FALSE}
divisaoCI = c(sum(!complete.cases(exp)),sum(complete.cases(exp)))
divisaoCI
sum(divisaoCI)
```
> <p style = 'text-align: justify;'>
Com a execução dos comandos anteriores verificamos que existem um total de 784 registos incompletos *DataSet* e 47323 registos completos, fazendo assim um total de 48107, como esperado. De forma a tornar possÌvel a análise dos dados, procedeu-se à remoção dos valores omissos.  
</p>
```{r , message = FALSE, warning = FALSE}
exp_complete=na.exclude(exp)
dim(exp_complete)
```
> <p style = 'text-align: justify;'>
Removendo os casos imcompletos verificamos que como suposto a dimenção do *DataSet* foi reduzido em 784.
</p>
> <p style = 'text-align: justify;'>
Para verificar se os nossos dados seguiam uma distribuição normal (0,1), calculámos a mèdia e desvio padrão dos dados do nosso 
*DataSet* com os seguintes comandos: 
</p>
```{r , message = FALSE, warning = FALSE}
c(mean(exp_complete),sd(exp_complete))
```
> <p style = 'text-align: justify;'>
com isto verificamos que os nosso dados não seguem uma distribuição normal (0,1). Pelo que se torna necessário normalizar-los recorrendo aos seguintes comandos: 
</p>

```{r , message = FALSE, warning = FALSE}
exp_norm=scale(exp_complete) 
c(mean(exp_norm),sd(exp_norm))
```
> <p style = 'text-align: justify;'>
agora os nosso dados seguem aproximadamente uma distribuição normal (0,1). Pelo que a partir de agora serão estes os dados a utilizar.
</p>

> <p style = 'text-align: justify;'>
De seguida, procurou-se remover os genes que possuiam valores pouco dispares ao longo das amostras, uma vez que não apresentam variabilidade significante para a distinção dos grupos amostrais.Para tal, procedeu-se seleção dos genes cujo desvio padrão dos valores de expressão ao longo das amostras è duas vezes superior do que a mediana dos desvios padrão de todos os genes.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
sds=rowSds(exp_norm)
m=median(sds)
hist(sds,breaks=50,col='mistyrose',xlab = 'Desvio padrão',ylab = 'Frequência',main = NULL)
abline(v=m*2,col="red",lwd=4,lty=2)
exp_filtrado=exp_complete[sds>=2*m,]
dim(exp_filtrado)
```
> <p style = 'text-align: justify;'>
Com este passo, reduziu-se os dados a utilizar nos seguintes passos para 7671 features.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
hist(rowSds(exp_filtrado),breaks=50,col='mistyrose',xlab = 'Desvio padrão',ylab = 'Frequência',main = NULL)
```

> <p style = 'text-align: justify;'>
Aplicação do filtro *Flat Patterns* aos dados originais e criação de um novo *ExpressionSet* para guardar estes dados.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
exp_filtrado2=data[sds>=2*m,]
```

> <p style = 'text-align: justify;'>
Para realizarmos testes de hipóteses paramétricos (t-test) foi necessário normalizar o *ExpressionSet* (exp_filtrado2) utilizado, mantendo os filtros (remoção de valores omissos e aplicação de filtros *"Flat Patterns"*). Para tal efeito foi preciso desenvolver a seguinte função responsável por dado um *ExpressionSet* com casso omissos e os nomes das colunas da matriz a este correpondente sem valores omissos.
</p>
```{r funcao, fig.align = 'center', message = FALSE, warning = FALSE}
getFromExpression <- function(expressionFonte,valuesOK)
{
  j=1
  nomes = featureNames(expressionFonte)
  indicesValuesOK =c()
  for(i in 1:length(valuesOK)){
    nomeOK = valuesOK[i]
    indices = which( nomes== nomeOK)
    if(length(indices) > 0){
      indicesValuesOK[j] = indices
      j=j+1
    }  
  }
  return(expressionFonte[indicesValuesOK,])
}
```

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
exp_filtrado2_matrix = exprs(exp_filtrado2)
exp_filtrado2 = getFromExpression(exp_filtrado2,rownames(exp_filtrado2_matrix[complete.cases(exp_filtrado2_matrix),]))
exp_filtrado2_matrix = scale(exprs(exp_filtrado2))
c(mean(exp_filtrado2_matrix), sd(exp_filtrado2_matrix))
phenoData1=phenoData(exp_filtrado2)
featData1=featureData(exp_filtrado2)
expData1=experimentData(exp_filtrado2)
normalized_exp_filtrado2=ExpressionSet(assayData = exp_filtrado2_matrix, phenoData = phenoData1, featureData = featData1, experimentData = expData1)
c(mean(exprs(normalized_exp_filtrado2)),sd(exprs(normalized_exp_filtrado2)),sum(is.na(exprs(normalized_exp_filtrado2))))
```
> <p style = 'text-align: justify;'>
 O código acima apresentado é resposável pela remoção dos valores omissos e normalização do *ExprecionSet* que será utilizado de agora em diante. Como é possivel de verificar pelo *output* do último comando executado. 
</p>

#Análise Expressão Diferencial e Enriquecimento

> <p style = 'text-align: justify;'>
Neste passo foram identificados, através de testes de hipóteses, os 25 genes que apresentavam menor *p-value*, ou seja, os genes cuja evidência estatística da expressão génica diferencial foi mais significativa. Os resultados obtidos foram registados nas seguintes tabelas e organizados segundo o nome do gene, identificador do gene e respetiva função. 
</p>

##Controlo x Lítio (1 mês de tratamento)

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test1=rowttests(normalized_exp_filtrado2[normalized_exp_filtrado2$time=="1 month"],"agent")
sign_pvalue1=test1[test1$p.value<0.01,]
pvalues1Signif=sign_pvalue1[order(sign_pvalue1$p.value),]
nomes1=rownames(pvalues1Signif)[1:25]
geneNames1=unlist(mget(nomes1, illuminaHumanv4SYMBOL))
geneFunction1=unlist(mget(nomes1, illuminaHumanv4GENENAME))
```

> <p style = 'text-align: justify;'>
Na seguinte tabela encontram-se os 25 genes com maior evidência estatística de expressão génica diferencial no que diz respeito ao atributo "agent". Este teste foi feito com o intuito de perceber se, após 1 mês de tratamento em questão (com lítio), existem diferenças estatisticamente
significativas na expressão dos genes. De facto, constatou-se que respectivos p-values (p-values < 0.01) permitem rejeitar a hipótese nula, pelo
que podemos assumir que os genes das amostras em condição de controlo e condição de tratamento com lítio são diferencialmente expressos. Numa primeira análise, isto pode indiciar uma influencia do lítio na expressão destes genes.
</p>

Nome do Gene | Nome da Variável | *p-value* | Função do Gene 
------------- | ------------- | ------------- | ------------- 
GRHL1 | ILMN_1769934 | 7.684359e-05|grainyhead like transcription factor 1
CES1 |ILMN_2359945  | 1.634422e-04|carboxylesterase 1
POLI | ILMN_1702218 | 3.172987e-04 |DNA polymerase iota
CWF19L1| ILMN_1651886 | 3.786476e-04 |CWF19-like 1, cell cycle control (S. pombe)
NA | ILMN_1905053 |4.822311e-04|NA
SNHG15 |ILMN_1898124|5.543943e-04|small nucleolar RNA host gene 15
SIGLEC10| ILMN_1655549|7.699869e-04|sialic acid binding Ig like lectin 10
BHMT2 | ILMN_2070521|  8.086180e-04| betaine--homocysteine S-methyltransferase 2
VPS33B | ILMN_1789243 |8.274346e-04|VPS33B, late endosome and lysosome associated
TSPAN12 | ILMN_1768115 | 8.607727e-04|tetraspanin 12
MCM3AP  | ILMN_1784766 |8.890522e-04|minichromosome maintenance complex component 3 associated protein
SNORD91B |  ILMN_3242443|  9.608578e-04|small nucleolar RNA, C/D box 91B
MICALCL | ILMN_1743232 | 1.147565e-03|MICAL C-terminal like
NOTCH2 | ILMN_1777845 | 1.270860e-03|notch 2
NA  | ILMN_3187754 |1.377986e-03|NA
CPZ |ILMN_1705258 |1.533117e-03|carboxypeptidase Z
NA | ILMN_1810104|1.730389e-03|NA 
CALD1  |  ILMN_1730487| 1.752684e-03|caldesmon 1
NCARD17 | ILMN_3238525|2.002094e-03|caspase recruitment domain family member 17
GIMAP8 | ILMN_1747305|2.159016e-03|GTPase, IMAP family member 8
TRPM2 | ILMN_2352380 |2.188820e-03|transient receptor potential cation channel subfamily M member 2
NCOA4 | ILMN_1773906 |2.199297e-03|nuclear receptor coactivator 4
SP140L | ILMN_1658858|2.211787e-03|SP140 nuclear body protein like
PTH | ILMN_2202048 |2.467427e-03|parathyroid hormone
NA | ILMN_1898268|2.518019e-03|NA

Table: **Tabela 2** -  25 Genes mais expressivos no teste estatístico entre os grupos de Controlo e Lítio após 1 mês de tratamento.

##Controlo x Litio (*Baseline*)
```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test2=rowttests(normalized_exp_filtrado2[normalized_exp_filtrado2$time=="baseline"],"agent")
sign_pvalue2=test2[test2$p.value<0.01,]
pvalues2Signif=sign_pvalue2[order(sign_pvalue2$p.value),]
nomes2=rownames(pvalues2Signif)[1:25]
geneNames2=unlist(mget(nomes2, illuminaHumanv4SYMBOL))
geneFunction2=unlist(mget(nomes2, illuminaHumanv4GENENAME))
```

> <p style = 'text-align: justify;'>
Na seguinte tabela encontram-se os 25 genes com maior evidência estatística de expressão génica diferencial no que diz respeito ao atributo *agent*. Este teste foi feito com o intuito de perceber se existem diferenças estatisticamente significativas na expressão dos genes no início da experiência. De facto, constatou-se que respectivos *p-values* (p-values < 0.01) permitem rejeitar a hipótese nula, pelo que podemos assumir que os genes das amostras em condição de controlo e condição de tratamento com lítio no ínicio do estudo são diferencialmente expressos. Numa primeira análise, isto pode indiciar uma influência do lítio na expressão destes genes. Tendo em conta os genes que obtivemos na tabela anterior, relativos a 1 mês de tratamento, podemos verificar que estes não são os mesmos obtidos na tabela seguinte. Estes resultados suportam a hipótese de que os genes obtidos na tabela anterior possam ser, de facto, influenciados ao nível da sua expressão pelo tratamento com lítio, uma vez que estes não apresentavam a maior diferença de expressão, comparativamente a outros genes, no início da experiência. 
</p>

Nome do Gene | Nome da Variável | *p-value* | Função do Gene 
------------- | ------------- | ------------- | -------------
SLC9B1|ILMN_1757606|1.924285e-05|solute carrier family 9 member B1
TAGLN2|ILMN_1766539|2.966484e-05|transgelin 2
FAAP20|ILMN_3182422|4.964620e-05|Fanconi anemia core complex associated protein 20
NA|ILMN_1810848|1.461253e-04|NA
EZR|ILMN_1795937|2.174945e-04|ezrin
FRA10AC1|ILMN_2375141|3.043571e-04|fragile site, folic acid type, rare, fra(10)(q23.3) or fra(10)(q24.2) candidate 1
NA|ILMN_1661043|3.068594e-04|NA
NA|ILMN_1902604|3.080951e-04|NA
RGS20|ILMN_1738558|3.989817e-04|regulator of G-protein signaling 20
STAT2|ILMN_1690921|7.059056e-04|signal transducer and activator of transcription 2
HIP1|ILMN_1701403|7.143332e-04|huntingtin interacting protein 1
NA|ILMN_1652436|8.891923e-04| NA
SNAPIN|ILMN_1799969|1.015630e-03|SNAP associated protein
PILRB|ILMN_1723984|1.051413e-03|paired immunoglobin-like type 2 receptor beta
GMCL1P1|ILMN_1778105|1.142194e-03|germ cell-less, spermatogenesis associated 1 pseudogene 1
WARS2|ILMN_2323979|1.230674e-03|tryptophanyl tRNA synthetase 2, mitochondrial
NA|ILMN_1675258|1.236474e-03| NA 
SUMF2|ILMN_2345872| 1.287137e-03|sulfatase modifying factor 2
WASF2|ILMN_1671837|1.376350e-03|WAS protein family member 2
NA|ILMN_1689699|1.481865e-03|NA 
ALOX12P2|ILMN_1735987| 1.503897e-03|arachidonate 12-lipoxygenase pseudogene 2
RAB5B|ILMN_1752582|1.552359e-03|RAB5B, member RAS oncogene family
RFX3|ILMN_1779488|1.576887e-03|regulatory factor X3
NA|ILMN_1721926|1.669918e-03| NA
LAMP3|ILMN_2170813|1.823372e-03|lysosomal associated membrane protein 3

Table: **Tabela 3** - 25 Genes mais expressivos no teste estatístico entre os grupos de Controlo e Lítio no instante incial.

##*Baseline* x 1 mês de tratamento (respondem ao tratamento com lítio)

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test3=rowttests(normalized_exp_filtrado2[normalized_exp_filtrado2$other=="responder" & normalized_exp_filtrado2$agent=="lithium"],"time")
sign_pvalue3=test3[test3$p.value<0.01,]
pvalues3Signif=sign_pvalue3[order(sign_pvalue3$p.value),]
nomes3=rownames(pvalues3Signif)
geneNames3=unlist(mget(nomes3, illuminaHumanv4SYMBOL))
geneFunction3=unlist(mget(nomes3, illuminaHumanv4GENENAME))
```

> <p style = 'text-align: justify;'>
Na seguinte tabela encontram-se os genes com maior evidência estatística de expressão génica diferencial no que diz respeito ao atributo *time* nas condições de resposta e tratamento com lítio. Este teste foi feito com o intuito de perceber, dentro dos indivíduos que foram tratados com lítio e responderam ao tratamento, quais os genes que após 1 mês do tratamento em questão (com lítio) apresentavam diferenças de expressão estatisticamente significativas relativamente à condição inicial (baseline). De facto, constatou-se que respectivos *p-values* (*p-values* < 0.01) permitem rejeitar a hipótese nula, pelo que podemos assumir que os genes dos indivíduos que foram tratados com lítio e responderam ao tratamento são diferencialmente expressos no inicío do tratamento e após um mês do começo do mesmo. 
</p>

Nome do Gene | Nome da Variável | *p-value* | Função do Gene 
------------- | ------------- | ------------- | -------------
FKBP5|ILMN_1778444|0.002436297|FK506 binding protein 5
LINC00293|ILMN_3311150|0.003073925|long intergenic non-protein coding RNA 293
CHM|ILMN_1709112|0.003880609|CHM, Rab escort protein 1
COX15|ILMN_2292696|0.007911662|COX15, cytochrome c oxidase assembly homolog
GTF2IRD2B|ILMN_2180997|0.009325567|GTF2I repeat domain containing 2B

Table: **Tabela 4** - 5 Genes mais expressivos no teste estatístico entre os grupos de que responderam e não responderam.

##Responde x Não responde (1 mês de Tratamento e Litio)

> <p style = 'text-align: justify;'>
Na seguinte tabela encontram-se os 25 genes com maior evidência estatística de expressão génica diferencial no que diz respeito ao atributo *other* após 1 mês de tratamento com lítio. Este teste foi feito com o intuito de perceber, dentro dos indivíduos que foram tratados com lítio durante 1 mês, quais os genes que apresentavam as maiores diferenças de expressão quando comparados os indivíduos que respondem e não respondem ao tratamento. A importância inside na possibilidade da resposta dos pacientes ao tratamento com lítio possa estar associada à regulação da expressão de alguns genes tornando-os, assim possíveis alvos para aumentar a eficácia do tratamento. 
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test4=rowttests(normalized_exp_filtrado2[normalized_exp_filtrado2$time=="1 month" & normalized_exp_filtrado2$agent=="lithium"],"other")
sign_pvalue4=test4[test4$p.value<0.01,]
pvalues4Signif=sign_pvalue4[order(sign_pvalue4$p.value),]
nomes4=rownames(pvalues4Signif)[1:25]
geneNames4=unlist(mget(nomes4, illuminaHumanv4SYMBOL))
geneFunction4=unlist(mget(nomes4, illuminaHumanv4GENENAME))
```

Nome do Gene | Nome da Variável | *p-value* | Função do Gene 
------------- | ------------- | ------------- | -------------
KIAA1191|ILMN_2376133|1.196106e-05|KIAA1191
SLC9A3R1|ILMN_1680925|1.222005e-05|SLC9A3 regulator 1
DESI1|ILMN_1737580|1.255400e-05|desumoylating isopeptidase 1
CYB5A|ILMN_2312194|2.853473e-05|cytochrome b5 type A
RNF182|ILMN_3243112|8.367740e-05|ring finger protein 182
MIR221|ILMN_3310326|1.990182e-04|microRNA 221
FHL2|ILMN_2355831|2.218453e-04|four and a half LIM domains 2
BNIP3L|ILMN_2045419|2.890585e-04|BCL2 interacting protein 3 like
NA|ILMN_1701314|3.093227e-044|NA
IFT20|ILMN_3235216|5.464933e-04|intraflagellar transport 20
PRCC|ILMN_1802843|6.224594e-04|papillary renal cell carcinoma (translocation-associated)
SET|ILMN_3210917|6.862697e-04| SET nuclear proto-oncogene
PRSS57|ILMN_1673605|8.264914e-04|protease, serine 57
CYBRD1|ILMN_1712305|8.664224e-04|cytochrome b reductase 1
NA|ILMN_1907834|9.189767e-04|NA 
ANKRD9|ILMN_2048607|9.999131e-04|ankyrin repeat domain 9
BTF3|ILMN_1659762|1.003584e-03| basic transcription factor 3
BUD13|ILMN_1749210|1.005300e-03|BUD13 homolog
DBNL|ILMN_2376289| 1.024758e-03|drebrin like
ADRM1|ILMN_2389013|1.156891e-03|adhesion regulating molecule 1
HPS1|ILMN_1741483|2.121442e-03|HPS1, biogenesis of lysosomal organelles complex 3 subunit 1
NA|ILMN_1740678| 2.592953e-03|NA
CDC26|ILMN_2210837|2.729218e-03|cell division cycle 26
STRADA|ILMN_2315694|2.899831e-03|STE20-related kinase adaptor alpha
KIAA0355|ILMN_1765696|3.068808e-03| KIAA0355

Table: **Tabela 5** - 25 Genes mais expressivos no teste estatístico entre os grupos de que responderam e não responderam após 1 mês de tratamento.

#Clustering de Genes e Amostras

#Análise Preditiva

#Resultados Obtidos

##Discussão

#Conclusão

#Referências
