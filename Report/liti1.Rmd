---
title: Extração de Conheciento de Bases Dados Biológicas
   <br />Bipolar Disorder and Response to Lithium
author: "Catarina Sousa pg32934 | Davide Lagoa pg31552 | João Silva a72023 <br /> José Morais pg32943 | Marta Moreno pg32847"
date: '`r format(Sys.Date(), "%d-%m-%Y")`'
bibliography: Referencias.bibtex
output:
  html_document:
    css: tableContents.css
    toc: true
    depth: 3
    number_sections: true 
    theme: cosmo 
    highlight: haddock
---
<img src="logo.png" style = "position:absolute;top:20px;left:100px;" />

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("gplots")
#install.packages("dendextend")#para por por no heatmap nas linhas
#install.packages("dendextendRcpp")#para por por no heatmap nas linhas
#install.packages("d3heatmap")#para fazer o heatmap
#install.packages("e1071")
source("http://bioconductor.org/biocLite.R")
biocLite()
#biocLite("GEOquery")
#biocLite("limma")
#biocLite("genefilter")
#biocLite("affydata")
#biocLite("affy")
#biocLite("illuminaHumanv4.db")
#biocLite("GOstats")
#biocLite("MLInterfaces")

library(Biobase) 
library(GEOquery)
library('genefilter')
library(limma)
library(gplots)
library(illuminaHumanv4.db)# por causa dos nossos genes serem illumina
library(dendextend)#heatmap
library(d3heatmap)#heatmap
library(matrixStats)
library(affydata)
library(affy)
library(imager)
library(GOstats)
library(MLInterfaces)
library(e1071)
```

# Introdução

> <p style = 'text-align: justify;'>O lítio é um dos medicamentos mais eficazes no tratamento do **transtorno bipolar**, no entanto a resposta dos pacientes ao qual é administrado é bastante heterogénea. Apesar de se terem efetuado diversos estudos com esse fim, ainda não foram identificados biomarcadores que possam ser utilizados para monitorizar e prever a resposta ao tratamento com lítio. O estudo a ser analisado procura **avaliar os efeitos do lítio sobre a expressão génica** ao identificar alterações na expressão de genes específicos 1 mês após o início do tratamento, sendo essa informação utilizada para prever os resultados ao fim de 6 meses.
</p>

> <p style = 'text-align: justify;'> Para o estudo foram recrutados 74 pacientes, sendo que 9 desistiram antes da primeira colheita de sangue e outros 5 apresentaram fraca qualidade ou quantidade insuficiente de RNA, pelo que não constam nos resultados. Os restantes **60 pacientes** foram **divididos em 2 grupos** criados aleatoriamente: um sujeito a tratamento com pelo menos um outro *medicamento que não lítio (OPT)*, e outro que fazia o tratamento anterior acoplado com a *toma de lítio (Li + OPT)*, sendo os grupos constituídos por 32 e 28 pacientes, respetivamente.
</p>

> <p style = 'text-align: justify;'> Para o grupo *Li + OPT*, 62 genes apresentaram indução diferencial entre os pacientes que responderam ao tratamento e os que não responderam ao tratamento. Os pacientes do grupo *Li + OPT* que responderam ao tratamento apresentavam padrões distintos que não foram observados nos pacientes do grupo *OPT* com resposta ao tratamento, sendo que estes últimos eram mais parecidos com os pacientes do grupo *Li + OPT* sem resposta ao tratamento.
</p>

> <p style = 'text-align: justify;'> Também foram realizados **testes utilizando RT-PCR** em tempo real de certos genes, tendo-se verificado que os resultados desta análise foram **similares aos obtidos com microarrays**, com os pacientes *Li + OPT* com resposta ao tratamento a demonstrarem uma maior indução desses genes do que os outros grupos. No entanto, com a exceção do gene *BCL2L1*, os resultados não foram estatisticamente significativos, o que corrobora o facto de que nos estudos com *microarrays* a maior diferença foi observada para *BCL2L1* [@beech2014gene].
</p>


#Dados

> <p style = 'text-align: justify;'>
*Download* e carregamento do *DataSet* escolhido para o trabalho:
</p>

```{r dataset, message = FALSE}
gds <- getGEO('GDS5393', destdir=".")  
```

> <p style = 'text-align: justify;'>
Conversão do *DataSet* para um *ExpressionSet*:
</p>

```{r expressionset, message = FALSE, warning = FALSE, dependson = "dataset"}
data <- GDS2eSet(gds,do.log2=TRUE) 
data
```
> <p style = 'text-align: justify;'>
Dimensão do *DataSet*: 
</p>
```{r , message = FALSE}
dim(data) 
```

> <p style = 'text-align: justify;'>
Conversão do *DataSet* para uma matiz numérica, contendo as *samples* nas colunas e as *features* nas linhas: 
</p>
```{r , message = FALSE}
exp = exprs(data)
class(exp)
exp[5:15,1:5]
```

> <p style = 'text-align: justify;'>
Fazendo um boxplot com o logaritmo de base 2 dos dados de expressão para todas as amostras facilmente verificamos a escala e distribuição dos dados a analisar. As caixas apresentam forma e centro muito distintas entre as amostras, indicando que os dados de expressão não estão normalizados. Posto isto é necessário proceder à sua filtragem e normalização.
</p>

```{r boxplot, fig.width = 10, fig.align = 'center',  message = FALSE, warning = FALSE}
#col = terrain.colors(length(pData(data)$sample), alpha = 0.6)
#dataBox = log2(exp)
#boxplot(dataBox, col = col, whiskcol = col, pch = 21, cex = 0.8, xlab = 'Amostras', ylab = 'Intensidades (log2)', notch = TRUE, frame = FALSE)
#depois descomentar esta a usar a imagem para nao demorar tanto 
library(imager)
im<-load.image("Rplot.png")
plot(im,axes=FALSE)
```


##Metadados

> <p style = 'text-align: justify;'> Resumo do conteúdo do *DataSet:* 
</p>

```{r , message = FALSE, warning = FALSE, dependson = "dataset"}
abstract(data)
```
> <p style = 'text-align: justify;'> Exemplo  para verificar o nome de algumas das amostras e identificadores dos genes:
</p>

```{r , message = FALSE, warning = FALSE, dependson = "dataset"}
sampleNames(data)[1:10]
featureNames(data)[1:8]
```

> <p style = 'text-align: justify;'> De maneira a solidificar o nosso conhecimento sobre o *DataSet* em estudo é muito útil termos uma ideia dos atributos disponíveis. 
</p>
```{r , message = FALSE, warning = FALSE, dependson = "dataset"}
varMetadata(data)
```
> <p style = 'text-align: justify;'> A execução do comando anterior permitiu identificar no nosso *DataSet* os seguintes atributos, sendo que nenhum deles apresenta descrição:
</p>

* sample
* agent
* other
* individual
* description
* time

> <p style = 'text-align: justify;'> Para aprofundar o nosso conhecimento sobre este *DataSet*, corremos os seguintes comandos de modo a organizar algumas ideias sobre os atributos disponíveis numa tabela. 
</p>

```{r , message = FALSE, warning = FALSE,results="hide"}
data$sample
data$agent
data$other
data$individual
data$description
data$time
```

Nome do Atributo | Significado  | Valores Distintos  | Valores Distintos 
------------- | ------------- | ------------- | -------------
sample | Amostras Disponíveis  | 120 | "GSM1105438" "GSM1105486"... 
agent | Tipo de Tratamento | 2 |  "control" "lithium"
other| Resposta ao Tratamento | 2 | "non-responder" "responder"
individual | Indivíduos em Análise  | 60 | "Li+OPT_1" "Li+OPT_10"...
description | Descrição da amostra | 120 | NULL
time |  Momento em que foi obtida a amostra  | 2 | "1 month" "baseline"

Table: **Tabela 1** - Informação contida no *DataSet* utilizado.

> <p style = 'text-align: justify;'> 
Resposta dos diferentes grupos, *control* e *lithium* ao tratamento aplicado:
</p>

```{r , message = FALSE, warning = FALSE,include=FALSE}
data_antes = data[,data$time=="baseline"]
data_depois = data[,data$time=="1 month"]


addmargins(table(data_antes$agent,data_antes$other))
addmargins(table(data_depois$agent,data_depois$other))
```

```{r , message = FALSE, warning = FALSE}
addmargins(table(data$agent,data$other))
```
##Tratamento dos Dados
> <p style = 'text-align: justify;'>
Verificação da existência de registos com valores omissos (*NA*) no *DataSet* :
</p>

```{r NAs, message = FALSE, warning = FALSE}
divisaoCI = c(sum(!complete.cases(exp)),sum(complete.cases(exp)))
divisaoCI
sum(divisaoCI)
```
> <p style = 'text-align: justify;'>
Com a execução dos comandos anteriores verificamos que existem um total de 784 registos incompletos no *DataSet* e 47323 registos completos, fazendo assim um total de 48107, como esperado. De forma a tornar possível a análise dos dados, procedeu-se à remoção dos valores omissos.  
</p>
```{r , message = FALSE, warning = FALSE}
exp_complete=na.exclude(exp)
dim(exp_complete)
```
> <p style = 'text-align: justify;'>
Removendo os casos incompletos verificamos que, como era suposto, a dimensão do *DataSet* foi reduzida para 47323.
</p>
> <p style = 'text-align: justify;'>
Para verificar se os dados seguiam uma distribuição normal (0,1), calculámos a média e desvio padrão dos dados do nosso 
*DataSet* com os seguintes comandos: 
</p>
```{r , message = FALSE, warning = FALSE}
c(mean(exp_complete),sd(exp_complete))
```
> <p style = 'text-align: justify;'>
Com isto verificamos que os dados não seguem uma distribuição normal (0,1). Pelo que se torna necessário normalizá-los recorrendo aos seguintes comandos: 
</p>

```{r , message = FALSE, warning = FALSE}
exp_norm=scale(exp_complete) 
c(mean(exp_norm),sd(exp_norm))
```
> <p style = 'text-align: justify;'>
Agora os nosso dados seguem aproximadamente uma distribuição normal (0,1), pelo que todas as análises posteriores serão feitas com base nos dados normalizados.
</p>

> <p style = 'text-align: justify;'>
De seguida, procurou-se remover os genes que possuíam valores pouco dispares ao longo das amostras, uma vez que não apresentam variabilidade significante para a distinção dos grupos amostrais. Para tal, procedeu-se à seleção dos genes cujo desvio padrão dos valores de expressão ao longo das amostras é duas vezes superior à mediana do desvio padrão de todos os genes.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
sds=rowSds(exp_norm)
m=median(sds)
hist(sds,breaks=50,col='mistyrose',xlab = 'Desvio padrão',ylab = 'Frequência',main = NULL)
abline(v=m*2,col="red",lwd=4,lty=2)
exp_filtrado=exp_complete[sds>=2*m,]
dim(exp_filtrado)
```
> <p style = 'text-align: justify;'>
Com este passo, reduziu-se os dados a utilizar nos passos seguintes para 7671 features.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
hist(rowSds(exp_filtrado),breaks=50,col='mistyrose',xlab = 'Desvio padrão',ylab = 'Frequência',main = NULL)
```

> <p style = 'text-align: justify;'>
Aplicação do filtro *Flat Patterns* aos dados originais e criação de um novo *ExpressionSet* para guardar estes dados:
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
exp_filtrado2=data[sds>=2*m,]
```

> <p style = 'text-align: justify;'>
Para realizarmos testes de hipóteses paramétricos (*t-test*) foi necessário normalizar o *ExpressionSet* (exp_filtrado2) utilizado, mantendo os filtros (remoção de valores omissos e aplicação de filtros *"Flat Patterns"*). Para tal, foi desenvolvida uma função que recebe um *ExpressionSet* com valores omissos, e uma lista com os nomes das linhas da matriz (que serão convertidos em índices), devolvendo um ExpressionSet sem os valores omissos.
</p>
```{r funcao, fig.align = 'center', message = FALSE, warning = FALSE}
getFromExpression <- function(expressionFonte,valuesOK)
{
  j=1
  nomes = featureNames(expressionFonte)
  indicesValuesOK =c()
  for(i in 1:length(valuesOK)){
    nomeOK = valuesOK[i]
    indices = which( nomes== nomeOK)
    if(length(indices) > 0){
      indicesValuesOK[j] = indices
      j=j+1
    }  
  }
  return(expressionFonte[indicesValuesOK,])
}
```

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
exp_filtrado2_matrix = exprs(exp_filtrado2)
exp_filtrado2 = getFromExpression(exp_filtrado2,rownames(exp_filtrado2_matrix[complete.cases(exp_filtrado2_matrix),]))
exp_filtrado2_matrix = scale(exprs(exp_filtrado2))
c(mean(exp_filtrado2_matrix), sd(exp_filtrado2_matrix))
phenoData1=phenoData(exp_filtrado2)
featData1=featureData(exp_filtrado2)
expData1=experimentData(exp_filtrado2)
normalized_exp_filtrado2=ExpressionSet(assayData = exp_filtrado2_matrix, phenoData = phenoData1, featureData = featData1, experimentData = expData1)
c(mean(exprs(normalized_exp_filtrado2)),sd(exprs(normalized_exp_filtrado2)),sum(is.na(exprs(normalized_exp_filtrado2))))
```
> <p style = 'text-align: justify;'>
O código acima apresentado, como é possivel verificar no *output* do último comando executado, é resposável pela remoção dos valores omissos e normalização do *ExpressionSet* a ser utilizado nos restantes passos.
</p>

#Análise de Expressão Diferencial e de Enriquecimento

> <p style = 'text-align: justify;'>
Neste passo foram identificados, através de testes de hipóteses, os 25 genes que apresentavam menor *p-value*, ou seja, os genes cuja evidência estatística da expressão génica diferencial foi mais significativa. Os resultados obtidos foram registados nas tabelas seguintes e organizados segundo o nome do gene, identificador do gene e respetiva função.
</p>

##Controlo x Lítio (1 mês de tratamento)

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test1=rowttests(normalized_exp_filtrado2[normalized_exp_filtrado2$time=="1 month"],"agent")
sign_pvalue1=test1[test1$p.value<0.01,]
pvalues1Signif=sign_pvalue1[order(sign_pvalue1$p.value),]
nomes1=rownames(pvalues1Signif)[1:25]
geneNames1=unlist(mget(nomes1, illuminaHumanv4SYMBOL))
geneFunction1=unlist(mget(nomes1, illuminaHumanv4GENENAME))
```
[@illumina]
> <p style = 'text-align: justify;'>
Na seguinte tabela encontram-se os 25 genes com maior evidência estatística de expressão génica diferencial no que diz respeito ao atributo "agent". Este teste foi feito com o intuito de perceber se, após 1 mês do tratamento em questão (com lítio), existem diferenças estatisticamente significativas na expressão dos genes. De facto, constatou-se que os  respectivos *p-values* (*p-values* < 0.01) permitem rejeitar a hipótese nula, pelo
que podemos assumir que os genes das amostras em condição de controlo e condição de tratamento com lítio são diferencialmente expressos. Numa primeira análise, isto pode indiciar uma influencia do lítio na expressão destes genes.
</p>

Nome do Gene | Nome da Variável | *p-value* | Função do Gene 
------------- | ------------- | ------------- | ------------- 
GRHL1 | ILMN_1769934 | 7.684359e-05|grainyhead like transcription factor 1
CES1 |ILMN_2359945  | 1.634422e-04|carboxylesterase 1
POLI | ILMN_1702218 | 3.172987e-04 |DNA polymerase iota
CWF19L1| ILMN_1651886 | 3.786476e-04 |CWF19-like 1, cell cycle control (S. pombe)
NA | ILMN_1905053 |4.822311e-04|NA
SNHG15 |ILMN_1898124|5.543943e-04|small nucleolar RNA host gene 15
SIGLEC10| ILMN_1655549|7.699869e-04|sialic acid binding Ig like lectin 10
BHMT2 | ILMN_2070521|  8.086180e-04| betaine--homocysteine S-methyltransferase 2
VPS33B | ILMN_1789243 |8.274346e-04|VPS33B, late endosome and lysosome associated
TSPAN12 | ILMN_1768115 | 8.607727e-04|tetraspanin 12
MCM3AP  | ILMN_1784766 |8.890522e-04|minichromosome maintenance complex component 3 associated protein
SNORD91B |  ILMN_3242443|  9.608578e-04|small nucleolar RNA, C/D box 91B
MICALCL | ILMN_1743232 | 1.147565e-03|MICAL C-terminal like
NOTCH2 | ILMN_1777845 | 1.270860e-03|notch 2
NA  | ILMN_3187754 |1.377986e-03|NA
CPZ |ILMN_1705258 |1.533117e-03|carboxypeptidase Z
NA | ILMN_1810104|1.730389e-03|NA 
CALD1  |  ILMN_1730487| 1.752684e-03|caldesmon 1
NCARD17 | ILMN_3238525|2.002094e-03|caspase recruitment domain family member 17
GIMAP8 | ILMN_1747305|2.159016e-03|GTPase, IMAP family member 8
TRPM2 | ILMN_2352380 |2.188820e-03|transient receptor potential cation channel subfamily M member 2
NCOA4 | ILMN_1773906 |2.199297e-03|nuclear receptor coactivator 4
SP140L | ILMN_1658858|2.211787e-03|SP140 nuclear body protein like
PTH | ILMN_2202048 |2.467427e-03|parathyroid hormone
NA | ILMN_1898268|2.518019e-03|NA

Table: **Tabela 2** -  Os 25 Genes com maior expressão diferencial no teste estatístico entre os grupos Controlo e Lítio após 1 mês de tratamento.

**Análise de enriquecimento para os genes diferencialmente expressos**

> <p style = 'text-align: justify;'>
Após a realização do *t-teste*, procedeu-se à análise de enriquecimento a fim de obtermos os termos GO associados aos genes mais diferencialmente expressos.
</p>


```{r , fig.align = 'center', message = FALSE, warning = FALSE}
filtrados1 = featureNames(normalized_exp_filtrado2) 
entrezID1= unlist(mget(filtrados1, illuminaHumanv4ENTREZID))  
pvalue1= test1$p.value<0.01
pvalFilt = normalized_exp_filtrado2[pvalue1,]
entrezIdSel1 = unlist(mget(featureNames(pvalFilt), illuminaHumanv4ENTREZID))
GO1 = new("GOHyperGParams", geneIds=entrezIdSel1, universeGeneIds=entrezID1, annotation="illuminaHumanv4.db", ontology="BP", pvalueCutoff=0.025, testDirection="over")
GO1_= hyperGTest(GO1)
```

 
> <p style = 'text-align: justify;'>
Na seguinte tabela, estão presentes os quinze termos *GO* com maior associação ao atributo *agent* (controlo/lítio), ao fim de 1 mês de tratamento. O termo mais presente é *regulation of growth*, o que nos indica que há genes, dentro dos mais diferencialmente expressos, envolvidos na regulação do crescimento celular. O lítio impede a formação de *inositol*, sendo responsável pelo aumento de *Ca+* e *Na+* no citoplasma neuronal, que por sua vez, nesta doença, aumenta o período refratário e a libertação de neurotransmissores, controlando assim os sintomas. Assim, havendo um aumento destes iões no citoplasma dos neurónios há, consequentemente, um aumento destes. Isto pode ser uma explicação para o termo *GO* mais presente, dentro dos genes mais diferencialmente expressos, estar associado à regulação do crescimento celular, podendo isto ser um indício da influência do lítio na expressão dos genes.[@cellmolecularBio]
</p>

ID de GO | *p-value* | Contagens de Termos GO | Termos
------------- | ------------- | ------------- | -------------
GO-0042045 | 0.004056914 | 2 | epithelial fluid transport
GO-0006826 | 0.005561774 | 3 | iron ion transport
GO-0006901 | 0.005561774 | 3 | vesicle coating
GO-0048207 | 0.005561774 | 3 | vesicle targeting, rough ER to cis-Golgi
GO-0048208 | 0.005561774 | 3 | COPII vesicle coating
GO-0001825 | 0.006003791 | 2 | blastocyst formation
GO-0048199 | 0.006506969 | 3 | vesicle targeting, to, from or within Golgi
GO-0090114 | 0.006506969 | 3 | COPII-coated vesicle budding
GO-0006903 | 0.008669374 | 3 | vesicle targeting
GO-0006626 | 0.008828329 | 4 | protein targeting to mitochondrion
GO-0000183 | 0.010909296 | 2 | chromatin silencing at rDNA
GO-0070633 | 0.010909296 | 2 | transepithelial transport
GO-0051650 | 0.012615235 | 5 | establishment of vesicle localization
GO-1903955 | 0.012618644 | 3 | positive regulation of protein targeting to mitochondrion
GO-0040008 | 0.015025500 | 8 | regulation of growth

Table: **Tabela 3** -  Tabela com os 15 termos GO mais associados aos genes diferencialmente expressos no que diz respeito à distinção das amostras de controlo e lítio ao fim de 1 mês de tratamento.

##Controlo x Lítio (*Baseline*)
```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test2=rowttests(normalized_exp_filtrado2[normalized_exp_filtrado2$time=="baseline"],"agent")
sign_pvalue2=test2[test2$p.value<0.01,]
pvalues2Signif=sign_pvalue2[order(sign_pvalue2$p.value),]
nomes2=rownames(pvalues2Signif)[1:25]
geneNames2=unlist(mget(nomes2, illuminaHumanv4SYMBOL))
geneFunction2=unlist(mget(nomes2, illuminaHumanv4GENENAME))
```

> <p style = 'text-align: justify;'>
Na seguinte tabela encontram-se os 25 genes com maior evidência estatística de expressão génica diferencial no que diz respeito ao atributo *agent*. Este teste foi feito com o intuito de perceber se existem diferenças estatisticamente significativas na expressão dos genes no início da experiência. De facto, constatou-se que os respectivos *p-values* (p-values < 0.01) permitem rejeitar a hipótese nula, pelo que podemos assumir que os genes das amostras em condição de controlo e condição de tratamento com lítio no ínicio do estudo são diferencialmente expressos. Numa primeira análise, isto pode indiciar uma influência do lítio na expressão destes genes, tendo em conta que os genes que obtivemos na tabela anterior, relativos a 1 mês de tratamento, não são os mesmos obtidos nesta tabela (Tabela 4). Estes resultados suportam a hipótese de que os genes obtidos na tabela anterior possam ser, de facto, influenciados ao nível da sua expressão pelo tratamento com lítio, uma vez que estes não apresentavam a maior diferença de expressão, comparativamente a outros genes, no início da experiência. 
</p>

Nome do Gene | Nome da Variável | *p-value* | Função do Gene 
------------- | ------------- | ------------- | -------------
SLC9B1|ILMN_1757606|1.924285e-05|solute carrier family 9 member B1
TAGLN2|ILMN_1766539|2.966484e-05|transgelin 2
FAAP20|ILMN_3182422|4.964620e-05|Fanconi anemia core complex associated protein 20
NA|ILMN_1810848|1.461253e-04|NA
EZR|ILMN_1795937|2.174945e-04|ezrin
FRA10AC1|ILMN_2375141|3.043571e-04|fragile site, folic acid type, rare, fra(10)(q23.3) or fra(10)(q24.2) candidate 1
NA|ILMN_1661043|3.068594e-04|NA
NA|ILMN_1902604|3.080951e-04|NA
RGS20|ILMN_1738558|3.989817e-04|regulator of G-protein signaling 20
STAT2|ILMN_1690921|7.059056e-04|signal transducer and activator of transcription 2
HIP1|ILMN_1701403|7.143332e-04|huntingtin interacting protein 1
NA|ILMN_1652436|8.891923e-04| NA
SNAPIN|ILMN_1799969|1.015630e-03|SNAP associated protein
PILRB|ILMN_1723984|1.051413e-03|paired immunoglobin-like type 2 receptor beta
GMCL1P1|ILMN_1778105|1.142194e-03|germ cell-less, spermatogenesis associated 1 pseudogene 1
WARS2|ILMN_2323979|1.230674e-03|tryptophanyl tRNA synthetase 2, mitochondrial
NA|ILMN_1675258|1.236474e-03| NA 
SUMF2|ILMN_2345872| 1.287137e-03|sulfatase modifying factor 2
WASF2|ILMN_1671837|1.376350e-03|WAS protein family member 2
NA|ILMN_1689699|1.481865e-03|NA 
ALOX12P2|ILMN_1735987| 1.503897e-03|arachidonate 12-lipoxygenase pseudogene 2
RAB5B|ILMN_1752582|1.552359e-03|RAB5B, member RAS oncogene family
RFX3|ILMN_1779488|1.576887e-03|regulatory factor X3
NA|ILMN_1721926|1.669918e-03| NA
LAMP3|ILMN_2170813|1.823372e-03|lysosomal associated membrane protein 3

Table: **Tabela 4** - Os 25 Genes com maior expressão diferencial no teste estatístico entre os grupos de Controlo e Lítio no instante inicial.

##*Baseline* x 1 mês de tratamento (respondem ao tratamento com lítio)

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test3=rowttests(normalized_exp_filtrado2[normalized_exp_filtrado2$other=="responder" & normalized_exp_filtrado2$agent=="lithium"],"time")
sign_pvalue3=test3[test3$p.value<0.01,]
pvalues3Signif=sign_pvalue3[order(sign_pvalue3$p.value),]
nomes3=rownames(pvalues3Signif)
geneNames3=unlist(mget(nomes3, illuminaHumanv4SYMBOL))
geneFunction3=unlist(mget(nomes3, illuminaHumanv4GENENAME))
```

> <p style = 'text-align: justify;'>
Na seguinte tabela encontram-se os genes com maior evidência estatística de expressão génica diferencial no que diz respeito ao atributo *time* nas condições de resposta e tratamento com lítio. Este teste foi feito com o intuito de perceber, de entre os indivíduos que foram tratados com lítio e responderam ao tratamento, quais os genes que após 1 mês do tratamento em questão (com lítio) apresentavam diferenças de expressão estatisticamente significativas relativamente à condição inicial (*baseline*). De facto, constatou-se que os respectivos *p-values* (*p-values* < 0.01) permitem rejeitar a hipótese nula, pelo que podemos assumir que os genes dos indivíduos que foram tratados com lítio e responderam ao tratamento são diferencialmente expressos no inicío do tratamento e um mês após o começo do mesmo. 
</p>

Nome do Gene | Nome da Variável | *p-value* | Função do Gene 
------------- | ------------- | ------------- | -------------
FKBP5|ILMN_1778444|0.002436297|FK506 binding protein 5
LINC00293|ILMN_3311150|0.003073925|long intergenic non-protein coding RNA 293
CHM|ILMN_1709112|0.003880609|CHM, Rab escort protein 1
COX15|ILMN_2292696|0.007911662|COX15, cytochrome c oxidase assembly homolog
GTF2IRD2B|ILMN_2180997|0.009325567|GTF2I repeat domain containing 2B

Table: **Tabela 5** - Os 5 Genes com maior expressão diferencial no teste estatístico entre os resultados no *baseline* e ao fim de 1 mês no grupo que respondeu ao tratamento.

**Análise de enriquecimento para os genes diferencialmente expressos**

> <p style = 'text-align: justify;'>
Após a realização do *t-teste*, procedemos à análise de enriquecimento a fim de obtermos os termos GO associados aos genes mais diferencialmente expressos.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
filtrados2 = featureNames(normalized_exp_filtrado2) 
entrezID2= unlist(mget(filtrados2, illuminaHumanv4ENTREZID))  
pvalue2= test3$p.value<0.01
pvalFilt = normalized_exp_filtrado2[pvalue2,]
entrezIdSel2 = unlist(mget(featureNames(pvalFilt), illuminaHumanv4ENTREZID))
GO2 = new("GOHyperGParams", geneIds=entrezIdSel2, universeGeneIds=entrezID2, annotation="illuminaHumanv4.db", ontology="BP", pvalueCutoff=0.025, testDirection="over")
GO2_= hyperGTest(GO2)

```
> <p style = 'text-align: justify;'>
Na tabela seguinte estão presentes os quinze termos *GO* com maior associação ao atributo *time* (*baseline*/1 mês de tratamento), em pacientes que responderam ao tratamento. Sendo que nenhum dos termos se destacou no que diz respeito à contagem, não podemos tirar conclusões específicas sobre nenhum deles em particular. No entanto, os termos resultantes estão relacionados com a fosforilação de compostos (*protein kinase A signaling*) e associados a neurotransmissores (*sequestering of neurotransmitter*) e à regulação positiva da resposta humoral (*positive regulation of humoral immune response*). Estes resultados vão de encontro ao que é pretendido no tratamento da doença bipolar. Deste modo, podemos prever que estes genes, de pacientes que respondem ao tratamento com lítio, diferencialmente expressos nas condições de *baseline* e 1 mês de tratamento, estão relacionados com a resposta do organismo ao lítio.[@cellmolecularBio]
</p>


ID de GO | *p-value* | Contagens de Termos GO | Termos
------------- | ------------- | ------------- | -------------
GO-0010737 | 0.001341132 | 2 | protein kinase A signaling
GO-0006865 | 0.003537452 | 2 | amino acid transport
GO-0015739 | 0.004326923 | 1 | sialic acid transport
GO-0042137 | 0.004326923 | 1 | sequestering of neurotransmitter
GO-0051389 | 0.004326923 | 1 | inactivation of MAPKK activity
GO-0060478 | 0.004326923 | 1 | acrosomal vesicle exocytosis
GO-0097401 | 0.004326923 | 1 | synaptic vesicle lumen acidification
GO-1902511 | 0.004326923 | 1 | negative regulation of apoptotic DNA fragmentation
GO-1903251 | 0.004326923 | 1 | multi-ciliated epithelial cell differentiation
GO-1903625 | 0.004326923 | 1 | negative regulation of DNA catabolic process
GO-2000507 | 0.004326923 | 1 | positive regulation of energy homeostasis
GO-0015849 | 0.007634964 | 2 | organic acid transport
GO-0002922 | 0.008636160 | 1 | positive regulation of humoral immune response
GO-0051938 | 0.008636160 | 1 | L-glutamate import
GO-0060467 | 0.008636160 | 1 | negative regulation of fertilization

Table: **Tabela 6** -  Tabela com os 15 termos GO mais associados aos genes diferencialmente expressos no que diz respeito à distinção das amostras *baseline* e primeiro mês de tratamento com lítio, em pacientes que responderam ao tratamento. 

##Responde x Não responde (1 mês de Tratamento e Litio)

> <p style = 'text-align: justify;'>
Na seguinte tabela encontram-se os 25 genes com maior evidência estatística de expressão génica diferencial no que diz respeito ao atributo *other* após 1 mês de tratamento com lítio. Este teste foi feito com o intuito de perceber, de entre os indivíduos que foram tratados com lítio durante 1 mês, quais os genes que apresentavam as maiores diferenças de expressão quando comparados os indivíduos que respondem e não respondem ao tratamento. A importância incide na possibilidade de que a resposta dos pacientes ao tratamento com lítio possa estar associada à regulação da expressão de alguns genes tornando-os, assim, possíveis alvos para aumentar a eficácia do tratamento.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test4=rowttests(normalized_exp_filtrado2[normalized_exp_filtrado2$time=="1 month" & normalized_exp_filtrado2$agent=="lithium"],"other")
sign_pvalue4=test4[test4$p.value<0.01,]
pvalues4Signif=sign_pvalue4[order(sign_pvalue4$p.value),]
nomes4=rownames(pvalues4Signif)[1:25]
geneNames4=unlist(mget(nomes4, illuminaHumanv4SYMBOL))
geneFunction4=unlist(mget(nomes4, illuminaHumanv4GENENAME))
```

Nome do Gene | Nome da Variável | *p-value* | Função do Gene 
------------- | ------------- | ------------- | -------------
KIAA1191|ILMN_2376133|1.196106e-05|KIAA1191
SLC9A3R1|ILMN_1680925|1.222005e-05|SLC9A3 regulator 1
DESI1|ILMN_1737580|1.255400e-05|desumoylating isopeptidase 1
CYB5A|ILMN_2312194|2.853473e-05|cytochrome b5 type A
RNF182|ILMN_3243112|8.367740e-05|ring finger protein 182
MIR221|ILMN_3310326|1.990182e-04|microRNA 221
FHL2|ILMN_2355831|2.218453e-04|four and a half LIM domains 2
BNIP3L|ILMN_2045419|2.890585e-04|BCL2 interacting protein 3 like
NA|ILMN_1701314|3.093227e-044|NA
IFT20|ILMN_3235216|5.464933e-04|intraflagellar transport 20
PRCC|ILMN_1802843|6.224594e-04|papillary renal cell carcinoma (translocation-associated)
SET|ILMN_3210917|6.862697e-04| SET nuclear proto-oncogene
PRSS57|ILMN_1673605|8.264914e-04|protease, serine 57
CYBRD1|ILMN_1712305|8.664224e-04|cytochrome b reductase 1
NA|ILMN_1907834|9.189767e-04|NA 
ANKRD9|ILMN_2048607|9.999131e-04|ankyrin repeat domain 9
BTF3|ILMN_1659762|1.003584e-03| basic transcription factor 3
BUD13|ILMN_1749210|1.005300e-03|BUD13 homolog
DBNL|ILMN_2376289| 1.024758e-03|drebrin like
ADRM1|ILMN_2389013|1.156891e-03|adhesion regulating molecule 1
HPS1|ILMN_1741483|2.121442e-03|HPS1, biogenesis of lysosomal organelles complex 3 subunit 1
NA|ILMN_1740678| 2.592953e-03|NA
CDC26|ILMN_2210837|2.729218e-03|cell division cycle 26
STRADA|ILMN_2315694|2.899831e-03|STE20-related kinase adaptor alpha
KIAA0355|ILMN_1765696|3.068808e-03| KIAA0355

Table: **Tabela 7** - 25 Genes mais expressivos no teste estatístico entre os grupos de que responderam e não responderam após 1 mês de tratamento.

**Análise de enriquecimento para os genes diferencialmente expressos**

> <p style = 'text-align: justify;'>
Após a realização do *t-teste*, procedemos à análise de enriquecimento a fim de obtermos os termos GO associados aos genes mais diferencialmente expressos.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
filtrados3= featureNames(normalized_exp_filtrado2) 
entrezID3= unlist(mget(filtrados3, illuminaHumanv4ENTREZID))  
pvalue3= test4$p.value<0.01
pvalFilt = normalized_exp_filtrado2[pvalue3,]
entrezIdSel3 = unlist(mget(featureNames(pvalFilt), illuminaHumanv4ENTREZID))
GO3 = new("GOHyperGParams", geneIds=entrezIdSel3, universeGeneIds=entrezID3, annotation="illuminaHumanv4.db", ontology="BP", pvalueCutoff=0.025, testDirection="over")
GO3_= hyperGTest(GO3)
```

> <p style = 'text-align: justify;'>
Na seguinte tabela, estão presentes os quinze termos *GO* com maior associação ao atributo *other* (responde/não responde), em pacientes que foram tratados com lítio, ao fim de 1 mês. Os termos mais presentes, dentro dos genes mais diferencialmente expressos são *negative regulation of cell proliferation* e *negative regulation of cell migration*. A descoberta da ocorrência de neurogénese (nascimento de novos neurónios) em cérebros adultos tem despoletado o interesse por estratégias de terapia celular para o tratamento de doenças associadas ao sistema neuronal. A neurogénese no cérebro adulto ocorre em duas áreas: (a) Zona Subgranular do hipocampo e (b) Zona Subventricular dos ventrículos laterais. A partir desses locais, os novos neurónios migram em direção aos seus alvos finais em outras áreas cerebrais onde se diferenciam e integram os circuitos locais. Diversos estudos têm mostrado que o tratamento farmacológico com lítio exerce efeitos sobre a neurogénese adulta, estimulando a sobrevivência e o amadurecimento de novos neurónios gerados no cérebro de roedores adultos. Assim, sendo que os genes com maior expressão diferencial, no que diz respeito a pacientes que responderam e não responderam ao tratamento com lítio, estão associados à proliferação e migração celular, podemos prever que o lítio seja capaz de despoletar estes mecanismos celulares e, deste modo, controlar os sintomas da doença bipolar.[@artigoLiti]
</p>


ID de GO | *p-value* | Contagens de Termos GO | Termos
------------- | ------------- | ------------- | -------------
GO-0008285 | 0.001755732 | 15 | negative regulation of cell proliferation
GO-0001890 | 0.003145789 | 6 | placenta development
GO-0016254 | 0.003783439 | 2 | preassembly of GPI anchor in ER membrane
GO-0042511 | 0.003783439 | 2 | positive regulation of tyrosine phosphorylation of Stat1 protein
GO-0080111 | 0.003783439 | 2 | DNA demethylation
GO-0033013 | 0.004122555 | 4 | tetrapyrrole metabolic process
GO-0030336 | 0.007006260 | 7 | negative regulation of cell migration
GO-0035510 | 0.007387835 | 2 | DNA dealkylation
GO-0042510 | 0.007387835 | 2 | regulation of tyrosine phosphorylation of Stat1 protein
GO-0070989 | 0.007387835 | 2 | oxidative demethylation
GO-0072538 | 0.007387835 | 2 | T-helper 17 type immune response
GO-2000146 | 0.009015351 | 7 | negative regulation of cell motility
GO-0030488 | 0.012022553 | 2 | tRNA methylation
GO-0042508 | 0.012022553 | 2 | tyrosine phosphorylation of Stat1 protein

Table: **Tabela 8** - Tabela com os 15 termos GO mais associados aos genes diferencialmente expressos no que diz respeito à distinção das amostras dos pacientes que respondem e não respondem ao tratamento no primeiro mês com lítio.

#Clustering de Genes e Amostras

**Funções utilizadas no Clustering**

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
heatMapAnalysis <- function(data,colors)
{
  Rowv = data %>% dist %>% hclust %>% as.dendrogram %>%
    set("branches_k_color", k = 4) %>% set("branches_lwd", 4) %>% ladderize
  Colv = data %>% t %>% dist %>% hclust %>% as.dendrogram %>%
    set("branches_k_color", k = 2, value = colors) %>%
    set("branches_lwd", 4) %>% ladderize
  d3heatmap(data,  Colv = Colv, Rowv = Rowv)
}

k_means <- function(data_clustering,Ncenters,legends,lables=c("","")){
  dataFrame=exprs(data_clustering)
  km = kmeans(dataFrame, centers=Ncenters)  
  plot(dataFrame, col=km$cluster, pch=19, cex=2, xlab =lables[1], ylab=lables[2])
  points(km$centers, col=1:2, pch=3, cex=3, lwd=3)
  legend("topleft", legend = legends, cex = 1, pch = 19, col = 1:3)
  
}
```

> <p style = 'text-align: justify;'>
No que diz respeito à análise de dados, construíram-se dois dendrogramas, um para o atributo *agent* e outro para o atributo *other*, a fim de proceder ao estudo dos clusters correspondentes. Para tal, usou-se apenas os vinte e cinco genes mais diferencialmente expressos do atributo dos respetivos metadados. A distância usada na obtenção dos *clusters* foi a *euclideana*. 
</p>

**Clustering associado ao *agent***
```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test_agent=rowttests(normalized_exp_filtrado2,"agent")
sign_pvalue_agent=test_agent$p.value<0.01
data_clustering = normalized_exp_filtrado2[sign_pvalue_agent][1:25]
datacluster=exprs(data_clustering)
nomes_agent=rownames(normalized_exp_filtrado2[sign_pvalue_agent])[1:25]
clust_nomes_agent=unlist(mget(nomes_agent, illuminaHumanv4SYMBOL))
rownames(datacluster) <- clust_nomes_agent
dist_euc = dist(datacluster)
cl.hier.complete <- hclust(dist_euc)
plot(cl.hier.complete, xlab="Distância euclideana",ylab="Altura")
```

> <p style = 'text-align: justify;'>
Usando os vinte e cinco genes com a maior diferença de expressão, obtidos na análise de expressão diferencial deste atributo dos metadados, é possível agrupar as amostras em dois grupos, tal como seria de prever, através da distância entre os genes.

</p>

> <p style = 'text-align: justify;'>
Uma  representação  gráfica  dos  dados  relacionada  com  o  *clustering  hierárquico*  são os *heatmaps*. Esta permite  representar  os  dados  como  uma  imagem  onde  cada  valor da matriz  de  dados  é  representado com uma célula cuja cor varia consoante o valor respetivo, num gradiente  de cores que pode ser configurado. Os *heatmaps* tipicamente incluem as árvores criadas  por  *clustering  hierárquico*  quer  ao  nível  das linhas,  quer  ao  nível  das  colunas  de  dados [@mrochap.g.ferreira2017].
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
heatMapAnalysis(datacluster,c("orange", "blue"))
```

> <p style = 'text-align: justify;'>
A partir dos resultados do *heatmap*, foi possível verificar que os nossos genes se organizaram em dois *clusters disitintos*, tal como se observou no resultado do *clustering hierárquico*. Assim, é possível deduzir que os genes relativos a cada grupo, de controlo e de tratamento com lítio, apresentam, efetivamente, expressão diferencial.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
k_means(data_clustering,2,c("Agent 1", "Agent 2"))
```

> <p style = 'text-align: justify;'>
O  problema  de  *clustering  k-means*  constitui  uma  das  possíveis  formulações do  *clustering*, onde o objetivo é o de minimizar a média do quadrado das distâncias de cada ponto  ao  centro  do  *cluster*  a  que  pertence. Assim, prevê-se que um dos grupos esteja mais intimamente ligado que outro. Isso pode também observar-se no *clustering hierárquico*, tendo em consideração as *distâncias euclideanas*.
</p>

**Clustering associado ao *other***

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
test_other=rowttests(normalized_exp_filtrado2,"other")
sign_pvalue_other=test_other$p.value<0.01
data_clustering2 = normalized_exp_filtrado2[sign_pvalue_other][1:25]
datacluster2=exprs(data_clustering2)
nomes_other=rownames(normalized_exp_filtrado2[sign_pvalue_other])[1:25]
clust_nomes_other=unlist(mget(nomes_other, illuminaHumanv4SYMBOL))
rownames(datacluster2) <- clust_nomes_other
dist_euc = dist(datacluster2)
cl.hier.complete <- hclust(dist_euc)
plot(cl.hier.complete, xlab="Distância euclideana",ylab="Altura")
```

> <p style = 'text-align: justify;'>
Usando os vinte e cinco genes com a maior diferença de expressão, obtidos na análise de expressão diferencial deste atributo dos metadados, é possível agrupar as amostras em dois grupos, tal como seria de prever, através da distância entre os genes.
</p>

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
heatMapAnalysis(datacluster2,c("orange", "blue"))
```

> <p style = 'text-align: justify;'>
A partir dos resultados do *heatmap*, é possível verificar que a distribuição da expressão dos genes de cada um dos grupos não é tão homogénea como se a que se observa no heatmap anterior. Assim, isto pode indiciar que dentro dos genes dos indivíduos que respondem ao tratamento alguns deles podem expressar-se mais intensamente, participando, assim, de forma mais ativa na resposta ao tratamento.
</p>


```{r , fig.align = 'center', message = FALSE, warning = FALSE}
k_means(data_clustering2,2,c("Other 1", "Other 2"))
```

> <p style = 'text-align: justify;'>
Tal como se verifica no *heatmap* anterior, a expressão génica dentro dos grupos é pouco homogénea o que sugere que nem todos os genes, que se expressam diferencialmente no que diz respeito a condições de resposta e não resposta, tenham a mesma participação na resposta ao tratamento, sendo previsível a existência de genes sub e sobrexpressos na resposta ao tratamento com lítio.
</p>

#Análise Preditiva

##*K-nearest Neighbors Algorithm*

**Previsão do tipo de tratamento**

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
knnResult.agent = MLearn(agent~., normalized_exp_filtrado2, knnI(k = 1), xvalSpec("LOG", 5, balKfold.xvspec(5)))
addmargins(confuMat(knnResult.agent))
precision(knnResult.agent)
```

> <p style = 'text-align: justify;'> 
Aplicando o método de *k-vizinhos mais próximos* ao tipo de tratamento, obteve-se um modelo com precisão de aproximadamente **`r precision(knnResult.agent)[1]`** para o tratamento controlo e **`r precision(knnResult.agent)[2]`** para o  tratamento com adição de lítio, o que nos indica que o modelo permite fazer previsões com uma precisão bastante razoável para ambos os casos.
</p>

**Previsão da resposta ao tratamento**

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
knnResult.other = MLearn(other ~ ., normalized_exp_filtrado2, knnI(k = 1), xvalSpec("LOG", 5, balKfold.xvspec(5)))
addmargins(confuMat(knnResult.other))
precision(knnResult.other)
```

> <p style = 'text-align: justify;'>
Aplicando o método de *k-vizinhos mais próximos* à resposta ao tratamento, obteve-se um modelo com precisão de **`r precision(knnResult.other)[1]`** para os pacientes que responderam ao tratamento e **`r precision(knnResult.other)[2]`** para  os pacientes que não responderam ao tratamento, indicando que o modelo permite fazer previsões com uma precisão bastante razoável para ambos os casos.
</p>

##*Regression Tree*

**Previsão do tipo de tratamento**

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
treeResult.agent = MLearn(agent~., normalized_exp_filtrado2,rpartI,
                           xvalSpec("LOG", 5, balKfold.xvspec(5)))
addmargins(confuMat(treeResult.agent))
precision(treeResult.agent)
```

> <p style = 'text-align: justify;'> 
Aplicando o método das árvores de regressão à resposta ao tipo de tratamento, obteve-se um modelo com precisão de **`r precision(treeResult.agent)[1]`** para o tratamento controlo e **`r precision(treeResult.agent)[2]`** para o tratamento com adição de lítio, indicando que, em ambos os casos, o modelo não permite realizar previsões com confiança.
</p>

**Previsão da resposta ao tratamento**

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
treeResult.other = MLearn(other ~ ., normalized_exp_filtrado2, rpartI, 
                          xvalSpec("LOG", 5, balKfold.xvspec(5)))
addmargins(confuMat(treeResult.other))
precision(treeResult.other)
```

> <p style = 'text-align: justify;'> 
Aplicando o método das árvores de regressão à resposta ao tratamento, obteve-se um modelo com precisão de **`r precision(treeResult.other)[1]`** para os pacientes que responderam ao tratamento e **`r precision(treeResult.other)[2]`** para  os pacientes que não responderam ao tratamento, indicando que o modelo permite fazer previsões com alguma precisão para os pacientes que responderam ao tratamento, mas com resultados menos fiáveis no caso do grupo da não-resposta.
</p>

##*Support Vector Machine*

**Previsão do tipo de tratamento**

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
svmResult.agent <- MLearn(agent~., normalized_exp_filtrado2, svmI,
                          xvalSpec("LOG", 5, balKfold.xvspec(5)))
addmargins(confuMat(svmResult.agent))
precision(svmResult.agent)
```

> <p style = 'text-align: justify;'> 
Aplicando o método das *SVM* à resposta ao tipo de tratamento, obteve-se um modelo com precisão de **`r precision(svmResult.agent)[1]`
** para o tratamento controlo e **`r precision(svmResult.agent)[2]`
** para o tratamento com adição de lítio, isto é, a precisão é bastante razoável para o grupo de controlo mas muito má no caso do grupo tratado com o lítio.
</p>

**Previsão da resposta ao tratamento**

```{r , fig.align = 'center', message = FALSE, warning = FALSE}
svmResult.other = MLearn(other ~ ., normalized_exp_filtrado2, svmI,
                         xvalSpec("LOG", 5, balKfold.xvspec(5)))
addmargins(confuMat(svmResult.other))
precision(svmResult.other)
```

> <p style = 'text-align: justify;'> 
Aplicando o método das *SVM* à resposta à resposta ao tratamento, obteve-se um modelo com precisão de **`r precision(svmResult.other)[1]`
** para os pacientes que não responderam ao tratamento e **`r precision(svmResult.other)[2]`
** para os pacientes que responderam ao tratamento, indicando que o modelo permite fazer previsões excelentes para os pacientes que não responderam ao tratamento, mas com resultados muito pouco fiáveis no caso do grupo que respondeu ao tratamento.
</p>

#Conclusão

> <p style = 'text-align: justify;'> 
Ao longo do decorrer do trabalho, fomo-nos apercebendo das dificuldades que o DataSet escolhido apresentava. O facto de o transtorno bipolar não ser uma doença manifestamente conhecida, tanto a nível de origem como de tratamento, dificultou o processo de interpretação dos resultados obtidos. Em particular, no que diz respeito à análise de expressão diferencial, as dificuldades foram bastantes por não ser totalmente conhecida a forma de atuação do transtorno bipolar no organismo.
</p>

> <p style = 'text-align: justify;'> 
Nos testes de hipóteses realizados concluímos que os genes com maiores diferenças estatísiticas significativas, obtidos para os *t-tests* realizados para os diferentes tipos de tratamento, não foram os mesmos para diferentes tempos experimentais. Isto sugere que, apesar de não ser possível relacionar diretamente estas diferenças com o tratamento com lítio, diferentes tipos de tratamento podem estar relacionados com a variabilidade da expressão de certos genes. Quanto às diferenças de expressão génica dentro de indivíduos que respondem ao tratamento com lítio nas diferentes linhas temporais, verificamos que apenas 5 genes se expressavam de forma efetivamente diferente quando comparamos o tempo inicial do estudo com 1 mês de tratamento. De entre os indivíduos que foram tratados com lítio durante 1 mês, tentou-se então perceber quais os genes que apresentavam as maiores diferenças de expressão quando comparados os indivíduos que respondem e não respondem ao tratamento. A importância incide na possibilidade de que a resposta dos pacientes ao tratamento com lítio possa estar associada à regulação da expressão de alguns genes tornando-os, assim, possíveis alvos para aumentar a eficácia do tratamento. Foi realizada, então, a análise de enriquecimento relativa aos genes de maior significância, a fim de ser possível perceber se estes estariam possivelmente relacionados com a doença. Os resultados obtidos sugerem que a expressão génica pode influenciar na resposta ao tratamento com lítio.
</p>

> <p style = 'text-align: justify;'> 
Quanto ao clustering, conseguimos perceber o claro agrupamento dos genes em dois grupos distintos, no que toca aos atributos dos metadados *agent* e *other*. No entanto, os resultados obtidos no *heatmap* e no *kmeans* indicam que o último atributo apresenta um *cluster* menos homogéneo. Isto pode estar associado ao facto de genes estarem sub e sobreexpressos no que diz respeito à resposta do organismo ao tratamento com lítio. 
Por fim, quanto à análise preditiva, pode concluir-se que, na maioria dos casos, de entre os métodos de análise preditiva estudados, o método dos *k-vizinhos* mais próximos será o mais adequado para este *DataSet*, uma vez que apresentou boa precisão na previsão de todas as variáveis. No entanto, as *máquinas de vetor de suporte* apresentam resultados excelentes (precisão **>95%**) caso haja interesse em prever quais os pacientes que não vão exibir resposta ao tratamento, o que vai de encontro a um dos objetivos deste estudo: poderá tornar possível determinar quando é preferível utilizar outro tratamento que não a toma de lítio.
</p>

#Referências